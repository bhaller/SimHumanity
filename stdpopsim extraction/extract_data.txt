#!/bin/bash

# assume we are being run from the "stdpopsim extraction" directory
cd "raw"

for filename in *.slim; do
	chrname=$(basename "$filename" .slim)
	echo $chrname "..."
	
	# add out_event.txt to the SLiM script generated by stdpopsim; it will
	# hijack the SLiM simulation to produce output files and stop
	(cat "$filename"; cat "../out_event.txt") | slim -d "CHR_NAME='$chrname'" > /dev/null 2>&1
done
